# src ディレクトリの責務サマリ

このドキュメントは `src` ディレクトリ内の各モジュールの責務をまとめたものです。

-   **`main/`**: Readability アルゴリズムの中核となる本文抽出処理を担当します。
    -   `extract.ts`: HTML ドキュメントから主要なコンテンツ候補を見つけ、スコアリングし、最終的な記事コンテンツを抽出します。メタデータ（タイトル、著者）の取得も行います。
    -   `preprocess.ts`: 本文抽出の前処理として、不要なタグ（ヘッダー、フッター、広告など）を削除します。
    -   `constants.ts`: 本文抽出アルゴリズムで使用される定数を定義します（スコアリング対象タグ、文字数閾値など）。
    -   `types.ts`: 本文抽出の結果 (`ReadabilityArticle`) やオプション (`ReadabilityOptions`) に関連する型を定義します。
-   **`nav/`**: アクセシビリティツリー (ARIA ツリー) の構築と操作を担当します。
    -   `aria.ts`: HTML ドキュメントから ARIA ツリーを構築し、圧縮、文字列化する機能を提供します。
    -   `links.ts`: ARIA ツリー内のリンクに重み付けを行い、フィルタリングする機能を提供します。
    -   `types.ts`: ARIA ツリー (`AriaTree`, `AriaNode`, `AriaNodeType`) に関連する型を定義します。
-   **`format/`**: 抽出されたコンテンツや ARIA ツリーを様々な形式（HTML, Markdown, プレーンテキスト）に変換する機能を提供します。
    -   `format.ts`: VElement を HTML 文字列やプレーンテキストに変換します。ノード数のカウントも行います。
    -   `markdown.ts`: VElement を Markdown 文字列に変換します。
-   **`classify/`**: 与えられた HTML ドキュメントが記事ページか、それ以外のページ（インデックス、リストなど）かを分類します。
    -   `classify.ts`: URL パターン、コンテンツの特性（テキスト長、リンク密度、見出し数など）に基づいてページタイプを判定します。
    -   `constants.ts`: ページ分類で使用される正規表現を定義します。
    -   `types.ts`: ページタイプ (`PageType`) の Enum を定義します。
-   **`dom.ts`**: 仮想 DOM (VNode, VElement, VText) の操作に関するユーティリティ関数を提供します。要素の取得、属性アクセス、可視性チェック、テキスト抽出、リンク密度計算などを行います。
-   **`parsers/`**: HTML 文字列を仮想 DOM に変換するパーサーを提供します。
    -   `parser.ts`: デフォルトのパーサーインターフェースと実装を提供します。
    -   `htmlparser2.ts`: `htmlparser2` ライブラリを使用したパーサー実装を提供します。
-   **`types.ts`**: プロジェクト全体で使用される基本的な仮想 DOM の型 (`VNode`, `VElement`, `VText`, `VDocument`) やパーサーの型 (`Parser`) を定義します。
-   **`constants.ts`**: プロジェクト全体で使用される共通の定数（正規表現など）を定義します。
-   **`index.ts`**: ライブラリの公開インターフェースを定義し、各モジュールの主要な関数や型をエクスポートします。